jQuery(function(o){if("undefined"==typeof everest_forms_params)return!1;var d={init:function(){o(document).ready(d.ready);var e=o(".evf-single-item-price-hidden input[type=hidden]").length,t=o(".evf-field-payment-single input[type=text]").length,n=o(".evf-single-item-price").find("span").length;0!==e&&0==t&&0==n?(o(".evf-single-item-price-hidden input[type=hidden]").closest(".evf-field-payment-single").hide(),o(".evf-field-payment-total").hide()):(o(".evf-single-item-price-hidden input[type=hidden]").closest(".evf-field-payment-single").hide(),o(".evf-field-payment-total").show()),this.load_validation(),d.bindUIActions()},ready:function(){d.loadPayments(),d.loadPhoneField()},load_validation:function(){if("undefined"==typeof o.fn.validate)return!1;o.validator.addMethod("confirm",function(e,t,n){return o.validator.methods.equalTo.call(this,e,t,n)},everest_forms_params.i18n_messages_confirm),o.validator.addMethod("extension",function(e,t,n){return n="string"==typeof n?n.replace(/,/g,"|"):"png|jpe?g|gif",this.optional(t)||e.match(new RegExp("\\.("+n+")$","i"))},everest_forms_params.i18n_messages_fileextension),o.validator.addMethod("maxsize",function(e,t,n){var i,s,r=n,a=this.optional(t);if(a)return a;if(t.files&&t.files.length)for(i=0,s=t.files.length;i<s;i++)if(t.files[i].size>r)return!1;return!0},everest_forms_params.i18n_messages_filesize),"undefined"!=typeof o.fn.intlTelInput&&o.validator.addMethod("smart-phone-field",function(e,t){return this.optional(t)||o(t).intlTelInput("isValidNumber")},everest_forms_params.i18n_messages_phone)},loadPayments:function(){d.amountTotal(o("div.evf-payment-total"))},loadPhoneField:function(){var i={};if("undefined"==typeof o.fn.intlTelInput)return!1;if("yes"!==everest_forms_params.disable_user_details&&(i.geoIpLookup=d.currentIpToCountry),"yes"===everest_forms_params.disable_user_details)var e=this.getFirstBrowserLanguage(),t=-1<e.indexOf("-")?e.split("-").pop():"";if(t){var n=window.intlTelInputGlobals.getCountryData();t=(n=n.filter(function(e){return e.iso2===t.toLowerCase()})).length?t:""}i.initialCountry="yes"===everest_forms_params.disable_user_details&&t?t:"auto",o(".evf-smart-phone-field").each(function(e,t){var n=o(t);i.hiddenInput=n.closest(".evf-field-phone").data("field-id"),i.utilsScript=everest_forms_pro_params.plugin_url+"assets/js/intlTelInput/utils.js",n.intlTelInput(i),n.removeAttr("name"),n.blur(function(){n.intlTelInput("isValidNumber")&&n.siblings('input[type="hidden"]').val(n.intlTelInput("getNumber"))})})},getFirstBrowserLanguage:function(){var e,t,n=window.navigator,i=["language","browserLanguage","systemLanguage","userLanguage"];if(Array.isArray(n.languages))for(e=0;e<n.languages.length;e++)if((t=n.languages[e])&&t.length)return t;for(e=0;e<i.length;e++)if((t=n[i[e]])&&t.length)return t;return""},currentIpToCountry:function(i){o.get("https://ipapi.co/json").always(function(e){var t=e&&e.country?e.country:"";if(!t){var n=d.getFirstBrowserLanguage();t=-1<n.indexOf("-")?n.split("-").pop():""}i(t)})},bindUIActions:function(){o(document).on("change input",".evf-payment-price",function(){d.amountTotal(this,!0)}),o(document.body).on("conditional_show conditional_hide",function(e,t){var n=o(t).find(".evf-payment-price");o(n).length&&d.amountTotal(n,!0)}),o(document).on("input",".evf-payment-user-input",function(){var e=o(this),t=e.val();e.val(t.replace(/[^0-9.,]/g,""))}),o(document).on("focusout",".evf-payment-user-input",function(){var e=o(this),t=e.val(),n=d.amountSanitize(t),i=d.amountFormat(n);e.val(i)}),o(".everest-forms-field-rating").hover(function(){o(this).parent().find(".everest-forms-field-rating").removeClass("selected hover"),o(this).prevAll().andSelf().addClass("hover")},function(){o(this).parent().find(".everest-forms-field-rating").removeClass("selected hover"),o(this).parent().find("input:checked").parent().prevAll().andSelf().addClass("selected")}),o(document).on("change",".everest-forms-field-rating input",function(){var e=o(this);e.closest(".everest-forms-field-rating-container").find(".everest-forms-field-rating").removeClass("hover selected"),e.parent().prevAll().andSelf().addClass("selected")}),o(document).ready(function(){o(".everest-forms-field-rating input:checked").change()})},amountTotal:function(e,n){n=n||!1;var t,i=o(e).closest(".everest-form"),s=0,r=0,a=d.getCurrency();i.find('.evf-field:visible .evf-payment-price, .evf-field .evf-single-item-price-hidden input[type="hidden"]').each(function(e,t){var n=o(this),i=0;"text"!==n.attr("type")&&"hidden"!==n.attr("type")||(i=n.val()),"radio"===n.attr("type")&&n.is(":checked")&&(i=n.data("amount")),"checkbox"===n.attr("type")&&n.is(":checked")&&(i=n.data("amount")),d.empty(i)||(i=d.amountSanitize(i),s=Number(s)+Number(i))}),t=d.amountFormat(s),r="left"===a.symbol_pos?a.symbol+" "+t:t+" "+a.symbol,i.find(".evf-payment-total").each(function(e,t){"hidden"===o(this).attr("type")||"text"===o(this).attr("type")?(o(this).val(r),"text"===o(this).attr("type")&&n&&o(this).valid()):o(this).text(r)})},amountSanitize:function(e){var t=d.getCurrency();return e=e.toString().replace(/[^0-9.,]/g,""),","===t.decimal_sep&&-1!==e.indexOf(t.decimal_sep)?("."===t.thousands_sep&&-1!==e.indexOf(t.thousands_sep)?e=e.replace(t.thousands_sep,""):""===t.thousands_sep&&-1!==e.indexOf(".")&&(e=e.replace(".","")),e=e.replace(t.decimal_sep,".")):","===t.thousands_sep&&-1!==e.indexOf(t.thousands_sep)&&(e=e.replace(t.thousands_sep,"")),d.numberFormat(e,2,".","")},amountFormat:function(e){var t=d.getCurrency();if(e=String(e),","===t.decimal_sep&&-1!==e.indexOf(t.decimal_sep)){var n=e.indexOf(t.decimal_sep);e=e.substr(0,n)+"."+e.substr(n+1,e.strlen-1)}return","===t.thousands_sep&&-1!==e.indexOf(t.thousands_sep)&&(e=e.replace(",","")),d.empty(e)&&(e=0),d.numberFormat(e,2,t.decimal_sep,t.thousands_sep)},getCurrency:function(){var e={code:"USD",thousands_sep:",",decimal_sep:".",symbol:"$",symbol_pos:"left"};return"undefined"!=typeof evf_settings.currency_code&&(e.code=evf_settings.currency_code),"undefined"!=typeof evf_settings.currency_thousands&&(e.thousands_sep=evf_settings.currency_thousands),"undefined"!=typeof evf_settings.currency_decimal&&(e.decimal_sep=evf_settings.currency_decimal),"undefined"!=typeof evf_settings.currency_symbol&&(e.symbol=evf_settings.currency_symbol),"undefined"!=typeof evf_settings.currency_symbol_pos&&(e.symbol_pos=evf_settings.currency_symbol_pos),e},numberFormat:function(e,t,n,i){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var s,r,a,o,d=isFinite(+e)?+e:0,l=isFinite(+t)?Math.abs(t):0,u=void 0===i?",":i,f=void 0===n?".":n;return 3<(s=(l?(r=d,a=l,o=Math.pow(10,a),""+(Math.round(r*o)/o).toFixed(a)):""+Math.round(d)).split("."))[0].length&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,u)),(s[1]||"").length<l&&(s[1]=s[1]||"",s[1]+=new Array(l-s[1].length+1).join("0")),s.join(f)},empty:function(e){var t,n,i,s=[void 0,null,!1,0,"","0"];for(n=0,i=s.length;n<i;n++)if(e===s[n])return!0;if("object"!=typeof e)return!1;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}};d.init(jQuery)});