"use strict";var emptySignature,signatureCans=document.getElementsByClassName("evf-signature-canvas"),signaturePads=Array(),ratio=Math.max(window.devicePixelRatio||1,1);if("undefined"!=signatureCans){for(var i in signatureCans)if(0<=i){var signatureCanvasParent=signatureCans[i].parentNode,formId=signatureCanvasParent.getAttribute("data-form-id"),fieldId=signatureCanvasParent.getAttribute("data-field-id");signatureCans[i].width=signatureCans[i].offsetWidth*ratio,signatureCans[i].height=signatureCans[i].offsetHeight*ratio,signatureCans[i].getContext("2d").scale(ratio,ratio),signaturePads[fieldId]=new SignaturePad(signatureCans[i],{penColor:evf_signature_params.pen_color,backgroundColor:evf_signature_params.background_color,throttle:0,onEnd:function(){var e=this._ctx.canvas.parentNode,t=e.getAttribute("data-field-id"),a="image/"+e.getAttribute("data-image-format");jQuery("#evf-signature-img-input-"+t).val(this.toDataURL(a)).trigger("input change").valid(),jQuery(e).closest(".evf-field-signature").removeClass("everest-forms-invalid").addClass("everest-forms-validated")}}),document.getElementById("everest-form-signature-reset-"+fieldId).addEventListener("click",function(){var e=this.getAttribute("id").replace("everest-form-signature-reset-","");document.getElementById("evf-signature-img-input-"+e).value="",signaturePads[e].clear()})}signaturePads.map(function(e,t){document.getElementById("everest-form-signature-reset-"+t).addEventListener("click",function(){document.getElementById("evf-signature-img-input-"+t).setAttribute("value",""),e.clear()})}),window.addEventListener("resize",function(){var e=Math.max(window.devicePixelRatio||1,1),t=document.getElementsByClassName("evf-signature-canvas");for(var a in t)if(0<=a){var i=t[a].getContext("2d");t[a].width=t[a].offsetWidth*e,t[a].height=t[a].offsetHeight*e,i.fillStyle=evf_signature_params.background_color,i.scale(e,e),i.clearRect(0,0,t[a].width,t[a].height),i.fillRect(0,0,t[a].width,t[a].height)}})}!function(n){n(document).ready(function(){n(".everest-forms-part-button").on("evf-init-part-change",function(){var e=n(".evf-signature-canvas");window.dispatchEvent(new Event("resize")),1<e.length&&n(".evf-signature-canvas").each(function(){var e=n(this).parent().attr("data-field-id"),t=document.getElementById("evf-signature-canvas-"+e).getContext("2d"),a=new Image,i=n("#evf-signature-img-input-"+e).val();0<i.length&&(a.src=i,t.drawImage(a,0,0))})})})}(jQuery);